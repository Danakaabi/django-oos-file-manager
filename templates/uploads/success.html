<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>تم الرفع</title>

  <!--
    ✅ هوية موحّدة مع صفحة "رفع ملف" (Latte Glass)
    - نفس الألوان: rose / lilac / mint
    - نفس الزجاجية + الحواف + الظلال
    - أمان: escape للمتغيرات + rel=noopener noreferrer + Referrer-Policy
    - JS خفيف وآمن: بدون innerHTML + Clipboard API مع fallback
  -->
  <meta http-equiv="Referrer-Policy" content="no-referrer" />

  <style>
    /* =========================
      THEME: Latte Glass (Unified)
    ========================== */
    :root{
      --bg0:#090A12;
      --bg1:#0E1020;

      --card: rgba(255,255,255,.07);
      --stroke: rgba(255,255,255,.10);

      --tx:#F4F0FF;
      --mut: rgba(244,240,255,.66);

      --rose:#F6B3C8;
      --lilac:#C9B6FF;
      --mint:#A8F0D6;

      --ok:#79E7C2;
      --warn:#F7D27D;
      --err:#FF8AA8;

      --r:24px;
      --sh: 0 22px 80px rgba(0,0,0,.58);

      --ring-rose: 0 0 0 4px rgba(246,179,200,.14);
      --ring-mint: 0 0 0 4px rgba(168,240,214,.14);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:grid;
      place-items:center;
      padding:16px;
      font-family: system-ui,-apple-system,"Segoe UI","Tajawal",sans-serif;
      color:var(--tx);

      background:
        radial-gradient(900px 520px at 18% 12%, rgba(246,179,200,.14), transparent 58%),
        radial-gradient(900px 520px at 85% 18%, rgba(201,182,255,.12), transparent 60%),
        radial-gradient(900px 520px at 52% 98%, rgba(168,240,214,.10), transparent 58%),
        linear-gradient(145deg,var(--bg0),var(--bg1));
    }

    /* =========================
      Card
    ========================== */
    .card{
      width:100%;
      max-width:560px;
      padding:24px;
      border-radius:var(--r);
      background: linear-gradient(180deg, rgba(255,255,255,.09), var(--card));
      border:1px solid var(--stroke);
      box-shadow:var(--sh);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      display:flex;
      flex-direction:column;
      gap:14px;
    }

    /* =========================
      Header
    ========================== */
    .head{
      display:flex;
      gap:12px;
      align-items:flex-start;
    }
    .icon{
      width:46px;height:46px;
      border-radius:16px;
      display:grid;place-items:center;
      background: linear-gradient(135deg, rgba(121,231,194,.18), rgba(201,182,255,.14));
      border:1px solid rgba(255,255,255,.14);
      flex:0 0 auto;
    }
    h1{
      margin:0;
      font-size:1.15rem;
      font-weight:950;
      letter-spacing:.2px;
    }
    .sub{
      margin-top:6px;
      color:var(--mut);
      font-size:.92rem;
      line-height:1.55;
    }

    /* =========================
      Panel (Details)
    ========================== */
    .panel{
      margin-top:4px;
      padding:12px;
      border-radius:18px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.045);
    }
    .row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      padding:10px 8px;
      border-bottom:1px solid rgba(255,255,255,.07);
    }
    .row:last-child{border-bottom:0}

    .k{
      color:var(--mut);
      font-size:.86rem;
      flex:0 0 auto;
    }
    .val{
      font-weight:900;
      max-width:340px;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
      text-align:left;
      direction:ltr;
    }

    a{
      color:var(--lilac);
      text-decoration:none;
    }
    a:hover{ text-decoration:underline; }

    /* =========================
      Actions
    ========================== */
    .actions{
      margin-top:2px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .btn{
      flex:1 1 180px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding:12px 14px;
      border-radius:16px;
      font-weight:950;
      border:0;
      cursor:pointer;
      text-decoration:none;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      transition: transform .18s ease, filter .18s ease, background .18s ease, opacity .18s ease;
    }

    /* Primary: نفس زر صفحة الرفع */
    .btn.primary{
      color:#120A1F;
      background: linear-gradient(135deg, var(--rose), var(--lilac));
      box-shadow: 0 16px 34px rgba(246,179,200,.14);
    }
    .btn.primary:hover{ transform: translateY(-2px); filter:brightness(1.03); }

    /* Secondary (copy): نعناع هادي */
    .btn.ok{
      color:#0E1020;
      background: linear-gradient(135deg, rgba(168,240,214,.95), rgba(246,179,200,.75));
      box-shadow: 0 14px 28px rgba(168,240,214,.10);
    }
    .btn.ok:hover{ transform: translateY(-1px); filter:brightness(1.03); }

    /* Ghost: رجوع */
    .btn.ghost{
      color:var(--tx);
      background: rgba(255,255,255,.06);
      border:1px solid var(--stroke);
    }
    .btn.ghost:hover{ transform: translateY(-1px); background: rgba(255,255,255,.08); }

    /* Focus visible (accessibility) */
    .btn:focus-visible{
      outline:none;
      box-shadow: var(--ring-rose);
    }

    /* =========================
      Footer note + toast
    ========================== */
    .note{
      margin-top:6px;
      text-align:center;
      color: rgba(244,240,255,.55);
      font-size:.82rem;
      line-height:1.6;
    }
    .toast{
      margin-top:8px;
      display:none;
      text-align:center;
      font-size:.84rem;
      color: rgba(244,240,255,.80);
    }

    @media (max-width:480px){
      .card{padding:20px}
      .val{max-width:220px}
    }
  </style>
</head>

<body>
  <!--
    Django context:
    - obj.original_name
    - obj.file.url
    أمان:
    - |escape لحماية العرض (حتى لو autoescape شغال)
    - فتح الرابط في تبويب جديد مع noopener/noreferrer
  -->
  <main class="card" role="main" aria-label="تم رفع الملف">
    <header class="head">
      <div class="icon" aria-hidden="true">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
          <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>

      <div>
        <h1>تم رفع الملف بنجاح</h1>
        <p class="sub">تم حفظ الملف. يمكنك فتحه، نسخ رابطه، أو رفع ملف جديد.</p>
      </div>
    </header>

    <section class="panel" aria-label="تفاصيل الملف">
      <div class="row">
        <div class="k">الاسم</div>
        <div class="val" title="{{ obj.original_name|escape }}">{{ obj.original_name|escape }}</div>
      </div>

      <div class="row">
        <div class="k">الرابط</div>
        <div class="val" title="{{ obj.file.url|escape }}">
          <a id="fileLink"
             href="{{ obj.file.url }}"
             target="_blank"
             rel="noopener noreferrer">
            {{ obj.file.url|escape }}
          </a>
        </div>
      </div>
    </section>

    <nav class="actions" aria-label="إجراءات">
      <a class="btn primary"
         href="{{ obj.file.url }}"
         target="_blank"
         rel="noopener noreferrer">
        فتح الملف
      </a>

      <button class="btn ok" type="button" id="copyBtn" aria-label="نسخ رابط الملف">
        نسخ الرابط
      </button>

      <!-- الأفضل: {% url 'upload' %} لو عندك اسم route -->
      <a class="btn ghost" href="/">
        رفع ملف جديد
      </a>
    </nav>

    <div class="toast" id="toast" role="status" aria-live="polite"></div>

    <p class="note">
      إذا كان الرابط طويل، سيظهر مختصرًا — افتحيه مباشرة أو انسخي الرابط.
    </p>
  </main>

  <script>
    /*
      Copy link (Safe + Minimal)
      - لا نستخدم innerHTML
      - Clipboard API مع fallback
      - يعتمد على HTTPS للنسخ بشكل أفضل
    */
    (() => {
      const linkEl = document.getElementById('fileLink');
      const btn = document.getElementById('copyBtn');
      const toast = document.getElementById('toast');

      const showToast = (msg) => {
        toast.textContent = msg;
        toast.style.display = 'block';
        window.clearTimeout(showToast._t);
        showToast._t = window.setTimeout(() => {
          toast.style.display = 'none';
          toast.textContent = '';
        }, 1700);
      };

      const copyText = async (text) => {
        if (navigator.clipboard && window.isSecureContext) {
          await navigator.clipboard.writeText(text);
          return;
        }
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.setAttribute('readonly', '');
        ta.style.position = 'fixed';
        ta.style.top = '-1000px';
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
      };

      btn.addEventListener('click', async () => {
        try {
          const url = linkEl ? linkEl.href : '';
          if (!url) return showToast('تعذر العثور على الرابط.');
          await copyText(url);
          showToast('تم نسخ الرابط ✅');
        } catch {
          showToast('لم يتم النسخ. جرّبي مرة أخرى.');
        }
      });
    })();
  </script>
</body>
</html>